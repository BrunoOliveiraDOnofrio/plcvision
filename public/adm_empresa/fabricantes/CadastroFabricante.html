<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../../css/fonts.css">
    <link rel="stylesheet" href="../../css/nav_side_bar.css">
    <link rel="stylesheet" href="../../css/StyleCadastroUsuario.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="../../js/nav_sidebar.js"></script>
    <title>Cadastro</title>
</head>

<body>

    <header class="header-nav">
        <div class="menu-foto">
            <i id="hamb_menu" onclick="abrirSideBar()" class='bx bx-menu'></i>
            <div class="foto"></div>
            <div class="barra-sep"></div>
        </div>

        <div class="user-options">
            <span id="username">Usuário</span>
            <i onclick="menuCollapse()" class='bx bx-chevron-down'></i>
            <div id="div_menu" class="collapse-menu">
                <nav>
                    <ul>
                        <li>
                            <a href="">
                                <span>Dashboard</span>
                            </a>
                        </li>
                        <li>
                            <a href="">
                                <span>Alertas</span>
                            </a>
                        </li>
                        <li>
                            <a href="">
                                <span>Perfil</span>
                            </a>
                        </li>
                        <li>
                            <a href="">
                                <span>Sair</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <header class="header-nav header-nav-desk">
        <div class="menu-foto">
            <i id="hamb_menu" onclick="abrirSideBar()" class='bx bx-menu'></i>
            <div class="fotoEmpresa"></div>
            <span id="span_empresa" class="nome-empresa">Motorola</span>
            <div class="barra-sep"></div>
            <span id="span_endereco_empresa" class="endereco">Alameda Ferraz 456</span>
        </div>

        <div class="user-options">
            <div class="foto"></div>
            <span id="username">Usuário</span>
            <i onclick="menuCollapseDesk()" class='bx bx-chevron-down'></i>
            <div id="div_menu_desk" class="collapse-menu">
                <nav>
                    <ul>
                        <li>
                            <a href="">
                                <span>Dashboard</span>
                            </a>
                        </li>
                        <li>
                            <a href="">
                                <span>Alertas</span>
                            </a>
                        </li>
                        <li>
                            <a href="">
                                <span>Perfil</span>
                            </a>
                        </li>
                        <li>
                            <a href="">
                                <span>Sair</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <!-- Side bar  -->

    <nav id="nav_sidebar" class="sidebar sidebar-fechada">
        <div class="inicio">
            <ul>
                <li>
                    <a href="./consumidores">
                        <i class='bx bx-group'></i>
                    </a>
                </li>
                <li>
                    <a href="./alertas">
                        <i class='bx bxs-bell-ring' ></i>
                    </a>
                </li>
                <li>
                    <a href="./fabricas">
                        <i class='bx bxs-factory'></i>
                    </a>
                </li>
                <li>
                    <a href="./setores">
                <i class='bx bx-category-alt'></i>
                        
                    </a>
                </li>
                <li>
                    <a href="./usuarios">
                        <i class='bx bxs-user'></i>
                    </a>
                </li>
                <li>
                    <a href="./plcs">
                        <i class='bx bx-desktop'></i>
                    </a>
                </li>
            </ul>
        </div>
        <div class="saida">
            <ul>
                <li>
                    <a href="#">
                        <i class='bx bx-exit' ></i>
                    </a>
                </li>
            </ul>
        </div>
     </nav>
    <!-- Cadastro do Usuário -->

    <div class="main">
        <div class="content">
            <div class="title">
                <h1>Cadastrar Fabricante:</h1>
            </div>
            <div class="box-register">
                <div class="box-field">
                    <div class="left-field">
                        <div class="field">
                            <span>Razão Social:</span>
                            <input type="text" id="ipt_razaoSocial">
                        </div>
                        <div class="field">
                            <span>CNPJ:</span>
                            <input type="text" id="ipt_cnpj">
                        </div>
                        <div class="field">
                            <span>Estado:</span>
                            <input type="text" id="ipt_estado">
                        </div>
                        <div class="field">
                            <span>Cidade:</span>
                            <input type="text" id="ipt_cidade">
                        </div>
                    </div>
                    <div class="right-field">
                        <div class="field">
                            <span>Bairro:</span>
                            <input type="text" id="ipt_bairro">
                        </div>
                        <div class="field">
                            <span>Logradouro:</span>
                            <input type="text" id="ipt_logradouro">
                        </div>
                        <div class="field">
                            <span>Número:</span>
                            <input type="text" id="ipt_numero">
                        </div>
                        <div class="field">
                            <span>Complemento:</span>
                            <input type="text" id="ipt_complemento">
                        </div>
                    </div>
                </div>
                <div class="buttons">
                    <button class="exit-button" onclick="">Cancelar</button>
                    <button class="register-button" onclick="cadastrar()">Cadastrar</button>
                </div>
            </div>
        </div>
    </div>

</body>

</html>

<script>
    async function cadastrar() {
    // Capturar os valores dos campos do formulário
    const razaoSocial = document.getElementById('ipt_razaoSocial').value.trim();
    const cnpj = document.getElementById('ipt_cnpj').value.trim();
    const estado = document.getElementById('ipt_estado').value.trim();
    const cidade = document.getElementById('ipt_cidade').value.trim();
    const bairro = document.getElementById('ipt_bairro').value.trim();
    const logradouro = document.getElementById('ipt_logradouro').value.trim();
    const numero = document.getElementById('ipt_numero').value.trim();
    const complemento = document.getElementById('ipt_complemento').value.trim();

    // Montar o objeto com os dados
    const dados = {
        razao_social: razaoSocial,
        cnpj: cnpj,
        estado: estado,
        cidade: cidade,
        bairro: bairro,
        logradouro: logradouro,
        numero: numero,
        complemento: complemento
    };

    // Verificar se todos os campos obrigatórios estão preenchidos
    if (!razaoSocial || !cnpj || !estado || !cidade || !bairro || !logradouro || !numero) {
        alert("Por favor, preencha todos os campos obrigatórios.");
        return;
    }

    try {
        // Enviar os dados para o backend
        console.log("Enviando dados para o backend:", dados);
        const response = await fetch('/fabricante', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(dados)
        });

        // Verificar a resposta do servidor
        if (response.ok) {
            const data = await response.json();
            console.log('Fabricante cadastrado com sucesso:', data);
            alert("Fabricante cadastrado com sucesso!");
            // Limpar os campos do formulário
            document.getElementById('ipt_razaoSocial').value = '';
            document.getElementById('ipt_cnpj').value = '';
            document.getElementById('ipt_estado').value = '';
            document.getElementById('ipt_cidade').value = '';
            document.getElementById('ipt_bairro').value = '';
            document.getElementById('ipt_logradouro').value = '';
            document.getElementById('ipt_numero').value = '';
            document.getElementById('ipt_complemento').value = '';
        } else {
            const errorText = await response.text();
            console.error('Erro ao cadastrar fabricante:', errorText);
            alert(`Erro ao cadastrar fabricante: ${response.statusText}`);
        }
    } catch (error) {
        console.error('Erro ao cadastrar fabricante:', error);
        alert("Erro ao cadastrar fabricante. Verifique sua conexão e tente novamente.");
    }
}
</script>