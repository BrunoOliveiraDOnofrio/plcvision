<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/StyleFuncionario.css">
    <title>Funcionários</title>
    <link rel="shortcut icon" type="imagex/png" href="../assets/imgs/logo-aba.png">
    <script src="../js/validacaosessao.js"></script>
</head>

<body onload="validacao_nivel_adm()">

    <div id="desfoque" class="desfoque"></div>

    <div class="body-container">
        <div class="sideBar">
            <div class="user">
                <h3>Bem vindo</h3>
            </div>
            <div class="tags_nav">
                <div class="tag">
                    <a href="./Monitoramento.html">Monitoramento</a>
                </div>
                <div class="tagF">
                    <a href="">Funcionários</a>
                </div>
                <div class="tag">
                    <a href="./Insigths.html">Insights</a>
                </div>
            </div>

            <div class="sair">
                <button onclick="sair()">Sair</button>
            </div>
        </div>

        <div class="main-content">
            <div class="container">
                <div class="header">
                    <h2>Funcionários Cadastrados</h2>
                    <div class="nav">
                        <button id="abrirModal" class="btn-Modal">Adicionar</button>

                        <dialog id="modal">
                            <button class="fechar" id="fecharModal">&times;</button>
                    
                            <div class="cadastroFuncionario">
                                Cadastrar<br>Funcionários
                    
                            </div>
                    
                                <div class="container-global">
                                    
                                    <div class="esquerda-cadastro">
                                        <div class="textfield">
                                            <label for="usuario">Usuário:</label><br>
                                            <input type="text" id="ipt_nomeFuncionario" placeholder="Insira o nome do funcionário">
                                        </div>
                                        
                                        <div class="textfield">
                                            <label for="e-mail">E-mail:</label><br>
                                            <input type="text" id="ipt_emailFuncionario" placeholder="Insira o e-mail do funcionário">
                                        </div>
                                        
                                        <div class="textfield">
                                            <label for="Senha">Senha:</label><br>
                                            <input type="password" id="ipt_senhaFuncionario" placeholder="Insira a senha">
                                        </div>
                    
                                        <div class="textfield">
                                            <label for="Confirmar">Confirmar:</label><br>
                                            <input type="password" id="ipt_confirmarSenhaFuncionario" placeholder="Confirme sua senha">
                                        </div>
                                    </div>
                    
                                    <div class="direita-cadastro">
                                        <div class="textfield">
                                            <label for="Celular">Celular:</label><br>
                                            <input type="text" id="ipt_celularFuncionario" placeholder="Número de telefone">
                                        </div>
                                        
                                        <div class="textfield">
                                            <label for="Nivel">Nivel:</label><br>
                                            <input type="text" id="ipt_nivelFuncionario" placeholder="Insira o nivel">
                                        </div>
                                        
                                        <div class="textfield">
                                            <label for="Setor">Setor:</label><br>
                                            <input type="text" id="ipt_setorFuncionario" placeholder="Insira seu setor">
                                        </div>
                                        
                                        <div class="textfield">
                                            <label for="Cargo">Cargo:</label><br>
                                            <input type="text" id="ipt_cargoFuncionario" placeholder="Insira seu cargo">
                                        </div>
                                    </div>
                                    
                                </div>
                    
                                <div class="botao-cadastrar">
                    
                                    <button onclick="cadastrar()">Cadastrar</button>
                    
                                </div>
                                
                        </dialog>


                        <button class="filtro">
                             Filtro
                        </button>
                        <input type="text" class="pesquisa" placeholder="Pesquisar">
                    </div>
                </div>

                <table>
                    <thead>
                        <tr>
                            <th>Código</th>
                            <th>Nome</th>
                            <th>Email</th>
                            <th>Setor</th>
                            <th>Nível</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>Carlos Silva</td>
                            <td>carlos.silva@siemens.com</td>
                            <td>Automação</td>
                            <td class="nivel">1</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Maria Oliveira</td>
                            <td>maria.oliveira@siemens.com</td>
                            <td>Engenharia</td>
                            <td class="nivel">2</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>João Souza</td>
                            <td>joao.souza@siemens.com</td>
                            <td>Manutenção</td>
                            <td class="nivel">0</td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>Fernanda Lima</td>
                            <td>fernanda.lima@siemens.com</td>
                            <td>Produção</td>
                            <td class="nivel">1</td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>Roberto Mendes</td>
                            <td>roberto.mendes@siemens.com</td>
                            <td>TI Industrial</td>
                            <td class="nivel">2</td>
            
                        </tr>
                        <tr>
                            <td>6</td>
                            <td>Ana Costa</td>
                            <td>ana.costa@siemens.com</td>
                            <td>Qualidade</td>
                            <td class="nivel">0</td>
            
                        </tr>    
                        <tr>
                            <td>8</td>
                            <td>Rafael Martins</td>
                            <td>rafael.martins@siemens.com</td>
                            <td>Instrumentação</td>
                            <td class="nivel">0</td>
                        </tr>
                        <tr>
                            <td>9</td>
                            <td>Beatriz Rocha</td>
                            <td>beatriz.rocha@siemens.com</td>
                            <td>Controle de Qualidade</td>
                            <td class="nivel">1</td>
                        </tr>
                        <tr>
                            <td>10</td>
                            <td>Eduardo Nunes</td>
                            <td>eduardo.nunes@siemens.com</td>
                            <td>Engenharia de Processos</td>
                            <td class="nivel">2</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</body>

</html>

<script>

const dialog = document.getElementById("modal");
        const abrirBtn = document.getElementById("abrirModal");
        const fecharBtn = document.getElementById("fecharModal");

        abrirBtn.addEventListener("click", () => {
            desfoque.style.display = "block"
            dialog.showModal();
        });

        fecharBtn.addEventListener("click", () => {
            desfoque.style.display = "none"
            dialog.close();
        });


        function validarCadastro() {
            
    var nome = ipt_nomeFuncionario.value;
    var email = ipt_emailFuncionario.value;
    var senha = ipt_senhaFuncionario.value;
    var confirmarSenha = ipt_confirmarSenhaFuncionario.value;
    var telefone = ipt_celularFuncionario.value;
    var nivel = ipt_nivelFuncionario.value;
    var setor = ipt_setorFuncionario.value;
    var cargo = ipt_cargoFuncionario.value;
    
    // Nome completo
    nome = nome.split(" ");
    if (nome == undefined || nome == '' || nome.length < 2) {
        alert("Nome completo inválido!");
        return false;
    }
    
    // Validação de e-mail
    var tamEmail = email.length;
    var isEnd = email.endsWith('.com') || email.endsWith('.br') || email.endsWith('.gov');
    var indices = [email.indexOf('.com'), email.indexOf('.br'), email.indexOf('.gov')].filter(i => i >= 0);
    var indiceEnd = indices.length > 0 ? Math.min(...indices) : -1;
    var indiceArroba = email.indexOf('@');
    var isArroba = indiceArroba !== -1 && indiceArroba < indiceEnd;

    if (email == undefined || email == '') {
        alert("Valor do email indefinido!");
        return false;
    }

    if (tamEmail < 8) {
        alert("Tamanho do email é inválido!");
        return false;
    }

    if (!isEnd || !isArroba) {
        alert("Email inválido!");
        return false;
    }
    
    // Senha
    var tamSenha = senha.length;
    var isEspecial = senha.includes("!") || senha.includes("@") || senha.includes("#") || senha.includes("$") || senha.includes("%") || senha.includes("^") || senha.includes("&") || senha.includes("*");
    var isMinuscula = false;
    var isMaiuscula = false;
    var isNum = false;        

    for(var i = 0; i < tamSenha; i++){
        if(senha[i] == senha[i].toUpperCase()){
            isMaiuscula = true;
        }

        if(senha[i] == senha[i].toLowerCase()){
            isMinuscula = true;
        }

        if(Number(parseFloat(senha[i])) == senha[i]){
            isNum = true;
        }
    }

    if (tamSenha < 8 || !isMinuscula || !isMaiuscula || !isEspecial || !isNum || senha == '') {
        alert("Senha inválida!");
        return false;
    }
    
    if (senha !== confirmarSenha) {
        alert("As senhas não coincidem!");
        return false;
    }
    
    // Telefone (13 dígitos)
    if (telefone == undefined || telefone == '' || telefone.length != 13) {
        alert("Número de telefone inválido!");
        return false;
    }
    
    // Nível de acesso (0, 1 ou 2)
    if ((nivel == undefined || nivel == '') || (nivel != 0 && nivel != 1 && nivel != 2)) {
        alert("Nível de acesso inválido!");
        return false;
    } 
    
    // Setor e Cargo
    if (setor == undefined || setor == ''){ 
        alert("Setor não definido!");
        return false;
    }
    
    if (cargo == undefined || cargo == '') {
        alert("Cargo não pode estar vazio!");
        return false;
    }
    
    alert("Cadastro realizado com sucesso!");
    return true;
}

function cadastrar() {
    if (validarCadastro()) {
        console.log("Dados validados. Enviando para o servidor...");
    }
}

</script>